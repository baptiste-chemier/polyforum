package application.polyforum.config;

import org.springframework.web.WebApplicationInitializer;

public class WebAppInitializer implements WebApplicationInitializer {

	@Override
    public void onStartup(ServletContext servletContext) throws ServletException {
        AnnotationConfigWebApplicationContext rootContext = 
                          new AnnotationConfigWebApplicationContext();
           
  //Déclaration de la classe de configuration 
  //du contexte (dataSource, repositories, spring-security …)
  rootContext.register(ContextConfig.class);
  servletContext.addListener(new ContextLoaderListener(rootContext));
  
  //Création du distapcher de servlet
  AnnotationConfigWebApplicationContext dispatcherServlet = 
                              new AnnotationConfigWebApplicationContext();
  dispatcherServlet.register(WebMvcConfig.class);

  //Déclaration du distapcher de servlet
  ServletRegistration.Dynamic dispatcher = servletContext.addServlet("dispatcher", 
                                     new DispatcherServlet(dispatcherServlet));
  dispatcher.setLoadOnStartup(1);
  dispatcher.addMapping("/");
 }
	
}
